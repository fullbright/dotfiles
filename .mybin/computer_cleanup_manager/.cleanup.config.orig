#!/bin/bash
#
# .cleanup.config - Configuration file for Mac cleanup scripts
#
# Copy this file to your home directory or project root and customize as needed.
# The scripts will automatically load this configuration if present.
#

# ============================================================================
# GitHub Configuration
# ============================================================================

# Your GitHub accounts/organizations (comma-separated)
# The script will prompt you to choose from these when creating repositories
DEFAULT_GITHUB_OWNERS="fullbright,BrightSoftwares,sergioafanou"

# Default owner for new repositories (optional)
# If set, this will be used without prompting
# DEFAULT_OWNER="fullbright"

# My GitHub accounts for repository detection
# Used to determine if a repository belongs to you
MY_GITHUB_ACCOUNTS=("fullbright" "BrightSoftwares" "sergioafanou")

# ============================================================================
# Directory Configuration
# ============================================================================

# Directory where completed/processed folders are moved
COMPLETED_FOLDER="$HOME/dev_completed"

# Backup directory for safety
BACKUP_DIR="$HOME/.cleanup_backups"

# State directory for tracking progress
STATE_DIR="$HOME/.cleanup_state"

# ============================================================================
# Dotfiles Configuration
# ============================================================================

# Dotfiles repository location
DOTFILES_REPO="$HOME/dotfiles"

# Dotfiles remote URL
DOTFILES_REMOTE="https://github.com/fullbright/dotfiles.git"

# ============================================================================
# Encryption Configuration
# ============================================================================

# GPG passphrase for encrypting sensitive files
# WARNING: Storing passphrases in config files is not secure
# Consider using environment variables or prompting for input instead
# GPG_PASSPHRASE="your-secure-passphrase-here"

# Sensitive file patterns to detect and encrypt
SENSITIVE_PATTERNS=(
    ".env"
    ".env.*"
    "*config.json"
    "*config.yaml"
    "*secrets.yml"
    "*keys.json"
    "*credentials*"
    "*.pem"
    "*.key"
    "*.p12"
    "*.pfx"
    "*_creds.py"
    "vinted_creds.py"
)

# ============================================================================
# Git Configuration
# ============================================================================

# Branch name prefix for migrations
BRANCH_PREFIX="migration-$(date +'%Y%m%d-%H%M%S')"

# Default commit message for automated commits
DEFAULT_COMMIT_MESSAGE="Automated migration from Mac cleanup"

# ============================================================================
# Processing Options
# ============================================================================

# Enable dry-run mode by default (true/false)
# In dry-run mode, no actual changes are made
DRY_RUN=false

# Enable verbose logging (true/false)
VERBOSE=true

# Batch size for processing multiple folders
BATCH_SIZE=1

# Automatically handle common project types (true/false)
AUTO_DETECT_PROJECT_TYPE=true

# ============================================================================
# Exclusion Patterns
# ============================================================================

# Folders to always skip during processing
SKIP_FOLDERS=(
    ".git"
    ".Trash"
    "node_modules"
    ".DS_Store"
)

# Patterns to exclude from copying/versioning
EXCLUDE_PATTERNS=(
    "*.log"
    "*.cache"
    "*_history"
    ".bash_history"
    ".zsh_history"
    "Cache/"
    "cache/"
    "Caches/"
    "node_modules/"
    "__pycache__/"
    "*.pyc"
    ".venv/"
    "venv/"
    "vendor/"
    ".sass-cache/"
)

# ============================================================================
# File Size Limits
# ============================================================================

# Maximum file size to include in git (in MB)
# Files larger than this will be flagged for review
MAX_FILE_SIZE_MB=50

# Warn about repositories larger than this size (in MB)
WARN_REPO_SIZE_MB=500

# ============================================================================
# Cleanup Automation
# ============================================================================

# Days to keep files in "to_delete" folder before purging
TO_DELETE_RETENTION_DAYS=90

# Automatically organize downloads folder (true/false)
AUTO_ORGANIZE_DOWNLOADS=false

# Downloads folder location
DOWNLOADS_FOLDER="$HOME/Downloads"

# to_triage folder location
TO_TRIAGE_FOLDER="$DOWNLOADS_FOLDER/to_triage"

# to_delete folder location
TO_DELETE_FOLDER="$DOWNLOADS_FOLDER/to_delete"

# ============================================================================
# Notification Configuration
# ============================================================================

# Enable notifications (requires terminal-notifier on macOS)
ENABLE_NOTIFICATIONS=false

# ============================================================================
# Project Type Detection
# ============================================================================

# Patterns for detecting project types
# Used to generate appropriate .gitignore files

# Node.js projects
NODEJS_INDICATORS=("package.json" "package-lock.json" "yarn.lock")

# Python projects
PYTHON_INDICATORS=("requirements.txt" "setup.py" "pyproject.toml" "Pipfile")

# PHP projects
PHP_INDICATORS=("composer.json" "composer.lock")

# Ruby projects
RUBY_INDICATORS=("Gemfile" "Gemfile.lock")

# Java projects
JAVA_INDICATORS=("pom.xml" "build.gradle" "build.gradle.kts")

# Go projects
GO_INDICATORS=("go.mod" "go.sum")

# Rust projects
RUST_INDICATORS=("Cargo.toml" "Cargo.lock")

# ============================================================================
# Advanced Options
# ============================================================================

# Create pull requests automatically after pushing (requires gh CLI)
AUTO_CREATE_PR=false

# Default PR title
DEFAULT_PR_TITLE="Automated migration from Mac cleanup"

# Enable git LFS for large files (requires git-lfs)
USE_GIT_LFS=false

# Parallel processing (number of jobs, 1 = sequential)
PARALLEL_JOBS=1

# ============================================================================
# Logging Configuration
# ============================================================================

# Log level (0=DEBUG, 1=INFO, 2=WARN, 3=ERROR, 4=SUCCESS)
LOG_LEVEL=1

# Keep logs for this many days
LOG_RETENTION_DAYS=30

# ============================================================================
# Safety Options
# ============================================================================

# Always create backups before destructive operations
ALWAYS_BACKUP=true

# Require confirmation for destructive operations
REQUIRE_CONFIRMATION=true

# Maximum number of folders to process in one session
# Set to 0 for unlimited
MAX_FOLDERS_PER_SESSION=0

# ============================================================================
# Custom Hooks (Advanced)
# ============================================================================

# Command to run before processing each folder
# Example: PRE_PROCESS_HOOK="echo 'Processing: $1'"
PRE_PROCESS_HOOK=""

# Command to run after processing each folder
# Example: POST_PROCESS_HOOK="echo 'Completed: $1'"
POST_PROCESS_HOOK=""

# Command to run on error
# Example: ERROR_HOOK="echo 'Error processing: $1'"
ERROR_HOOK=""

# ============================================================================
# Environment-Specific Settings
# ============================================================================

# Detect environment
if [[ "$(uname)" == "Darwin" ]]; then
    # macOS-specific settings
    USE_MACOS_NOTIFICATIONS=true
    FILE_MANAGER_CMD="open"
elif [[ "$(uname)" == "Linux" ]]; then
    # Linux-specific settings
    USE_MACOS_NOTIFICATIONS=false
    FILE_MANAGER_CMD="xdg-open"
fi

# ============================================================================
# Load User Overrides
# ============================================================================

# Source user-specific config if it exists
if [[ -f "$HOME/.cleanup.local.config" ]]; then
    source "$HOME/.cleanup.local.config"
fi
